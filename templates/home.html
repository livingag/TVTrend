{% extends "base.html" %}

{% block head %}
<title>TVTrend</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.js"></script>
<!-- <link href="http://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.css" rel="stylesheet"/> -->
<script type="text/javascript">

    $(document).ready(function () {
        $('.ui.search')
            .search({
                type: 'standard',
                source: {{shownames|tojson|safe}},
                searchFields: ['title'],
                onSelect: function (result, response) {
                    document.getElementById("test").value = result['title']
                    document.getElementById("showForm").submit();
                }
            });

    });
</script>
{% endblock %}

{% block content %}
<div class="ui container">

    <div class="ui middle aligned grid" style="height: 80%;">
    <div class="ui twelve wide column">
    <h1>TVTrend</h1>
    <p>Visualise trends of user ratings for TV shows</p>
    {% with messages = get_flashed_messages() %}
    {% if messages %}
        {% for message in messages %}
        <div class="ui negative message">
            <i class="close icon"></i>
            <div class="header">
                Plotting failed:
            </div>
            <p>{{ message }}</p>
        </div>
        {% endfor %}
    {% endif %}
    {% endwith %}

    <form class="ui form" id="showForm" action="{{ url_for('search') }}" method="POST" onkeydown="return event.key != 'Enter';">
        <div class="ui search">
            <div class="ui icon input" style="width: 70%;">
                <input class="prompt" name="showname" placeholder="Show name..." type="text" id="test">
                <i class="search icon"></i>
            </div>
            <div class="results" style="width: 70%;"></div>
        </div>
    </form>
    <p>Try <a href="{{ url_for('plot_show',imdbId='tt0411008',source='imdb') }}">Lost</a>, <a href="{{ url_for('plot_show',imdbId='tt0903747',source='imdb') }}">Breaking Bad</a>, or <a href="{{ url_for('plot_show',imdbId='tt0944947',source='imdb') }}">Game of Thrones</a></p>
    <p><small>Source on <a href="http://github.com/livingag/TVTrend">GitHub</a></small></p>
    </div></div>
</div>
<script>
    document.getElementById('searchButton').addEventListener('click', function() {
        var d = document.getElementById('searchBar');
        d.className += " loading";
    });
    $(document).ready(function (){
        $('.message .close').on('click', function () {
            $(this).closest('.message').transition('fade');
        });
    })
</script>
{% endblock %}